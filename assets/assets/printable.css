/* assets/assets/printable.css (最終修正版) */

@page {
    size: A4 portrait;
    margin: 15mm;
}

@media print {
    /* =================================== */
    /* 基本設定 & リセット */
    /* =================================== */
    html, body {
        margin: 0 !important;
        padding: 0 !important;
        background: #fff !important;
        font-size: 9pt;
        -webkit-print-color-adjust: exact !important;
        print-color-adjust: exact !important;
    }
    
    * {
        box-sizing: border-box !important;
    }

    /* =================================== */
    /* 非表示/表示要素の指定 */
    /* =================================== */
    #report-header,
    #report-header + hr,
    #report-comment-input /* コメント入力欄を非表示に */ {
        display: none !important;
    }

    #printable-comment-output /* 印刷用のコメント表示エリアを表示に */ {
        display: block !important;
    }


    /* =================================== */
    /* レイアウト調整 */
    /* =================================== */
    
    #report-dashboard-content > .row > .col-md-8,
    #report-dashboard-content > .row > .col-md-4 {
        flex: 0 0 100% !important;
        max-width: 100% !important;
        padding: 0 !important;
    }
    
    /* 縦棒グラフ群(右列)のレイアウト */
    #subject-charts-row {
        display: flex !important;
        flex-direction: row !important;
        flex-wrap: wrap !important;
        width: 100% !important;
        margin: 0 !important;
        padding: 0 !important;
        page-break-inside: avoid !important;
    }
    
    #subject-charts-row > * {
        flex: 0 0 25% !important;
        max-width: 25% !important;
        padding: 3px !important;
        page-break-inside: avoid !important;
    }

    /* ★★★ 修正: グラフの幅を強制的に100%にする ★★★ */
    #report-dashboard-content .js-plotly-plot .svg-container,
    #report-dashboard-content .js-plotly-plot svg.main-svg {
        width: 100% !important;
    }


    /* =================================== */
    /* その他共通スタイル */
    /* =================================== */
    .page-break {
        page-break-after: always;
    }
    
    /* ★★★ 修正: 印刷用コメント欄のスタイル ★★★ */
    #printable-comment-output {
        border: 1px solid #ccc !important;
        background-color: #f8f9fa !important;
        color: #000 !important;
        padding: 10px;
        min-height: 150px; /* 内容が少なくても最低限の高さを確保 */
        white-space: pre-wrap; /* 改行やスペースをそのまま表示 */
        word-wrap: break-word; /* 長い単語を折り返す */
    }

    .card, .js-plotly-plot { 
        box-shadow: none !important; 
        border: 1px solid #ddd !important; 
    }

    .row, .col, .card, h2, h4, .table { 
        page-break-inside: avoid; 
    }
    h2, h4 { 
        page-break-after: avoid; 
    }
}
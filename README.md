# アーカイブディレクトリ

このディレクトリには、モジュール分割前の元ファイルが保存されています。

## ファイル一覧

- `progress-dashboard-original.py`: 元の4100行モノリシックファイル
  - モジュール分割前のバックアップ
  - 機能は新しいapp.pyとモジュール群で実現されています

## 新しい構造

現在のアプリケーションは以下の構造で動作しています：

```
app.py                    # メインアプリケーション (10.00/10 Pylintスコア)
├── callbacks/            # コールバック処理
│   ├── admin_callbacks.py
│   ├── main_callbacks.py  
│   ├── progress_callbacks.py
│   └── student_callbacks.py
├── charts/               # グラフ生成
│   ├── chart_generator.py
│   └── generator.py
├── components/           # UI コンポーネント
│   └── main_layout.py
├── config/               # 設定ファイル
│   └── settings.py
├── data/                 # データ処理
│   └── processor.py
└── utils/                # ユーティリティ
   └── __init__.py
```

全てのモジュールで10.00/10のPylintスコアを達成しています。

## データ構造
- `route-subject-text-time.json` は以下のようなネスト構造：
  - 校舎 → ユーザー → 生徒 → { progress, student_data }
    - progress: 科目 → ルートレベル → 参考書名 → 進捗情報
    - student_data: 偏差値など生徒属性

## セットアップ
1. 必要なPythonパッケージをインストール
   ```sh
   pip install -r requirements.txt
   ```
2. アプリを起動
   ```sh
   python app_with_auth_json.py
   ```

## テスト
`tests/` ディレクトリ内のテストスクリプトで動作確認できます。

## ライセンス
MIT License

## ✨ 主な機能

### 🔐 認証システム
- **ユーザー認証**: セキュアなログイン/ログアウト機能
- **新規ユーザー登録**: セルフサービスでのアカウント作成### 🏃‍♀️ 使用方法

### 1. ログイン・新規登録
1. http://localhost:8050/login にアクセス
2. **既存ユーザー**: 「ログイン」タブでデフォルトアカウントでログイン
3. **新規ユーザー**: 「新規登録」タブで新しいアカウントを作成
   - ユーザー名（必須）
   - 表示名（任意）
   - ユーザー種別（一般ユーザー/管理者）
   - パスワード（6文字以上、必須）
4. ダッシュボードが表示される役割ベースアクセス制御**: 管理者と一般ユーザーの権限分離
- **セッション管理**: 自動セッション延長とセキュリティ
- **プロフィール管理**: ユーザー情報の表示・編集
- **パスワード変更**: セキュアなパスワード更新機能

### 📊 ダッシュボード機能
- **リアルタイム進捗視覚化**: インタラクティブなグラフとチャート
- **科目別分析**: 各科目の学習進捗を詳細表示
- **学習データ管理**: CSV形式でのデータ入出力
- **フィルタリング機能**: 日付範囲、科目、学習者による絞り込み
- **レスポンシブデザイン**: デスクトップ・モバイル対応

### 🛠 管理機能
- **ユーザー管理**: 管理者による全ユーザーの管理
- **データ管理**: 学習データの一括操作
- **システム管理**: バックアップ機能（今後実装予定）

## 🏗 システム アーキテクチャ

```
progress-dashboard-python/
│
├── 📱 メインアプリケーション
│   ├── app_with_auth.py          # 認証付きメインアプリ
│   ├── app.py                    # 基本版アプリ
│   └── progress-dashboard.py     # オリジナル版
│
├── 🔐 認証システム (auth/)
│   ├── user_manager.py           # ユーザー管理 [Pylint: 10.00/10]
│   ├── session_manager.py        # セッション管理 [Pylint: 9.34/10]
│   └── auth_utils.py            # 認証ユーティリティ [Pylint: 9.82/10]
│
├── 🎛 コールバック処理 (callbacks/)
│   ├── auth_callbacks.py         # 認証コールバック [Pylint: 10.00/10]
│   ├── main_callbacks.py         # メインコールバック
│   ├── admin_callbacks.py        # 管理者コールバック
│   ├── progress_callbacks.py     # 進捗コールバック
│   └── student_callbacks.py      # 学生コールバック
│
├── 🧩 UI コンポーネント (components/)
│   ├── main_layout.py            # メインレイアウト
│   ├── login_components.py       # ログイン画面
│   └── modals.py                # モーダルダイアログ
│
├── 📊 チャート生成 (charts/)
│   ├── generator.py              # チャート生成ロジック
│   └── chart_generator.py        # グラフ作成
│
├── 🗃 データ処理 (data/)
│   └── processor.py              # CSV処理・データ管理
│
├── ⚙️ 設定 (config/)
│   ├── settings.py              # アプリケーション設定
│   └── styles.py               # CSS・デザイン設定
│
├── 🔧 ユーティリティ (utils/)
│   └── __init__.py             # ヘルパー関数
│
└── 📈 データ分析ツール
    ├── clean_csv.py             # CSVクリーニング [Pylint: 9.25/10]
    ├── analyze_csv.py           # データ分析 [Pylint: 9.86/10]
    └── analyze_csv_issues.py    # データ品質分析 [Pylint: 9.44/10]
```

## 🚀 セットアップ & 実行

### 前提条件

- Python 3.8以上
- pip パッケージマネージャー

### 必要なパッケージ

```bash
# 必須パッケージのインストール
pip install dash dash-bootstrap-components pandas plotly sqlite3
```

### インストール手順

1. **リポジトリのクローン**
   ```bash
   git clone [リポジトリURL]
   cd progress-dashboard-python
   ```

2. **依存関係のインストール**
   ```bash
   pip install -r requirements.txt  # requirements.txtがある場合
   # または手動で：
   pip install dash dash-bootstrap-components pandas plotly
   ```

3. **CSVデータの準備**
   ```bash
   # サンプルデータをroute-subject-text-time.csvとして配置
   # または既存のCSVデータをクリーニング：
   python clean_csv.py
   ```

### 🏃 アプリケーションの起動

#### 認証機能付き版（推奨）
```bash
python app_with_auth.py
```

#### 基本版（認証なし）
```bash
python app.py
```

### 🌐 アクセス

アプリケーション起動後、ブラウザで以下にアクセス：
- **URL**: http://localhost:8050/login
- **ポート**: 8050（デフォルト）

## 👤 デフォルトアカウント

### 管理者アカウント
- **ユーザー名**: `admin`
- **パスワード**: `admin123`
- **権限**: 全データアクセス、ユーザー管理、管理者メニュー

### 一般ユーザーアカウント
- **ユーザー名**: `test_user`
- **パスワード**: `password123`
- **権限**: 自分のデータのみアクセス

## 🔧 設定のカスタマイズ

### アプリケーション設定 (`config/settings.py`)

```python
APP_CONFIG = {
    'host': '127.0.0.1',        # サーバーホスト
    'port': 8050,               # ポート番号
    'debug_mode': True,         # デバッグモード
    'auto_open_browser': True   # 自動ブラウザ起動
}
```

### CSS・デザイン設定 (`config/styles.py`)

外部スタイルシートとカスタムCSSを管理

## 📊 データ形式

### CSV データ構造
```csv
生徒,科目,項目,時刻
田中太郎,数学,代数,2025-01-01 10:00:00
田中太郎,英語,文法,2025-01-01 11:00:00
```

### 必須カラム
- `生徒`: 学習者名
- `科目`: 学習科目
- `項目`: 学習項目・単元
- `時刻`: 学習日時（YYYY-MM-DD HH:MM:SS形式）

## 🛡 セキュリティ機能

### 認証・認可
- **パスワードハッシュ化**: SHA-256による安全な保存
- **セッション管理**: UUIDベースのセッショントークン
- **役割ベースアクセス制御**: 管理者・ユーザーの権限分離
- **自動ログアウト**: セッション有効期限管理

### データ保護
- **SQLiteデータベース**: ユーザー情報の安全な保存
- **ユーザー別データ分離**: 一般ユーザーは自分のデータのみアクセス
- **セッション自動延長**: アクティブユーザーのセッション維持

## 📈 コード品質

### Pylint スコア実績
- 🏆 **`user_manager.py`**: 10.00/10 (完璧)
- 🏆 **`auth_callbacks.py`**: 10.00/10 (完璧)
- 🥇 **`analyze_csv.py`**: 9.86/10
- 🥇 **`app_with_auth.py`**: 9.85/10
- 🥇 **`auth_utils.py`**: 9.82/10
- 🥇 **`analyze_csv_issues.py`**: 9.44/10
- 🥇 **`session_manager.py`**: 9.34/10
- 🥇 **`clean_csv.py`**: 9.25/10

### 品質保証
- **コードスタイル**: PEP 8準拠
- **型ヒント**: Type hints使用
- **ドキュメント**: 包括的なdocstring
- **エラーハンドリング**: 適切な例外処理

## 🔄 データ処理ツール

### CSVクリーニング
```bash
python clean_csv.py
```
- 重複データの除去（67.5%のデータ削減実績）
- データ品質の向上
- 不整合な記録の修正

### データ分析
```bash
python analyze_csv.py          # 基本的なデータ分析
python analyze_csv_issues.py   # データ品質分析
```

## 🏃‍♀️ 使用方法

### 1. ログイン
1. http://localhost:8050/login にアクセス
2. デフォルトアカウントでログイン
3. ダッシュボードが表示される

### 2. データの表示
- **科目選択**: ドロップダウンから科目を選択
- **日付フィルター**: 期間を指定してデータを絞り込み
- **グラフ操作**: インタラクティブなズーム・パン操作

### 3. 管理機能（管理者のみ）
- **ユーザー管理**: `/admin`ページでユーザー操作
- **全データ表示**: 全学習者のデータを統合表示
- **システム管理**: データバックアップ・復元

### 4. プロフィール管理
- **右上メニュー**: ユーザープロフィールアクセス
- **パスワード変更**: セキュアなパスワード更新
- **ログアウト**: 安全なセッション終了

## 🔮 今後の機能拡張予定

### 近日実装予定
- **進捗管理ページ**: `/progress`での詳細進捗追跡
- **データエクスポート**: PDF・Excel形式での出力
- **通知システム**: 学習リマインダー機能
- **詳細な分析**: 学習パターン分析・推奨機能

### 将来の機能
- **API連携**: 外部学習管理システムとの連携
- **モバイルアプリ**: ネイティブアプリ版
- **AI分析**: 機械学習による学習最適化提案
- **多言語対応**: 国際化対応

## 🤝 貢献・開発

### 開発環境のセットアップ
```bash
# 開発用追加パッケージ
pip install pylint black flake8

# コード品質チェック
python -m pylint [ファイル名].py

# コードフォーマット
black [ファイル名].py
```

### ファイル構成の理解
- **認証システム**: `auth/`フォルダ
- **UI コンポーネント**: `components/`フォルダ  
- **ビジネスロジック**: `callbacks/`フォルダ
- **設定ファイル**: `config/`フォルダ

## 📝 ライセンス

このプロジェクトはMITライセンスの下で公開されています。

## 🆘 トラブルシューティング

### よくある問題

#### 1. ポートが使用中
```bash
# ポートを変更する場合 (config/settings.py)
APP_CONFIG = {
    'port': 8051  # 別のポートを指定
}
```

#### 2. CSVファイルが見つからない
```bash
# ファイルパスの確認
ls route-subject-text-time.csv
# またはサンプルデータの作成
python clean_csv.py
```

#### 3. データベースエラー
```bash
# データベースファイルの削除・再作成
rm users.db sessions.db
python app_with_auth.py  # 自動的に再作成される
```

### パフォーマンス最適化

#### 大量データの処理
- CSVデータのクリーニング: `python clean_csv.py`
- データの事前フィルタリング
- 適切なインデックス設定

#### メモリ使用量の削減
- チャンク処理によるCSV読み込み
- 不要なデータのガベージコレクション

## 📞 サポート

問題が発生した場合や機能要望がある場合は、以下の方法でお知らせください：

1. **GitHubイシュー**: バグレポート・機能要望
2. **開発者コンタクト**: 技術的な質問・相談
3. **ドキュメント改善**: README・コメントの改善提案

---

**開発者**: GitHub Copilot  
**最終更新**: 2025年10月2日  
**バージョン**: 1.0.0

🎯 **プロジェクトの目標**: 学習データの効率的な管理と進捗の可視化を通じて、より良い学習体験を提供する